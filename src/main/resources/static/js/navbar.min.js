$(document).ready(function(){isLogin();setAClickListener();setSearchFormValidateLisener()});function isLogin(){$.ajax({url:requestmap.user_isLogged,type:"get",async:false,success:function(a){if(a.status===1){userInfo=a.resultMap.loggedUserInfo;$("nav.navbar ul.navbar-right:eq(1)").hide();$("nav.navbar ul.navbar-right:eq(0)").show();$("#index-navbar-ualias").text(userInfo.ualias);$("#index-navbar-uavatar").attr("src",userInfo.uavatar)}else{$("nav.navbar ul.navbar-right:eq(1)").show();$("nav.navbar ul.navbar-right:eq(0)").hide()}console.log("登陆的用户信息",userInfo)}})}function setSearchFormValidateLisener(){$("#navbar-search-form").bootstrapValidator({message:"*输入不合法",container:"#none",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{"navbar-search-form-keyword-input":{message:"*关键字不合法",validators:{notEmpty:{message:"*请输入关键字进行搜索"}}}}}).on("success.form.bv",function(a){a.preventDefault();$("#navbar-search-form-submit-button").button("loading");searchKeywords={name:$("#navbar-search-form-keyword-input").val()};console.log("保存搜索内容: "+searchKeywords);$.get(requestmap.store_search_keywords,searchKeywords,function(b){if(b.status===1){isSearchResult=true;console.log("搜索到相关信息进行显示:");console.log(b);showAllGame()}else{myAlert("未找到相关游戏!")}$("#navbar-search-form-submit-button").button("reset")})})}function setAClickListener(){$("nav.navbar ul.navbar-nav:eq(0) > li:eq(0) > a").on("click",function(){$("nav.navbar ul.navbar-nav > li").removeClass("active");$(this).parent().addClass("active")});$("nav.navbar ul.navbar-nav:eq(0) > li:eq(1) > ul > li > a").on("click",function(){$("nav.navbar ul.navbar-nav > li").removeClass("active");$(this).parent().parent().parent().addClass("active");let type=$(this).text();$(this).parent().parent().prev().html(type+"<span class='caret'></span>");console.log("导航栏游戏标签-导航栏游戏标签类别：",type);restoreSearchConditonDefault();console.log("导航栏游戏标签-还原默认后的搜索条件：",searchCondition);switch(type){case"免费游戏":searchCondition.minPrice=0;searchCondition.maxPrice=0;break;case"新游上线":searchCondition.tag=JSON.stringify(["newsale"]);break;case"即将上线":searchCondition.tag=JSON.stringify(["presale"]);break;case"促销游戏":searchCondition.sort="discount";break;case"动作":searchCondition.category=JSON.stringify(["动作"]);break;case"射击":searchCondition.category=JSON.stringify(["射击"]);break;case"策略":searchCondition.category=JSON.stringify(["策略"]);break;case"模拟":searchCondition.category=JSON.stringify(["模拟"]);break;case"独立":searchCondition.category=JSON.stringify(["独立"]);break;case"角色扮演":searchCondition.category=JSON.stringify(["角色扮演"]);break;case"所有游戏":break;default:break}console.log("导航栏游戏标签-展示所有游戏前的查询条件：",JSON.stringify(searchCondition));showAllGame()});$("nav.navbar ul.navbar-nav:eq(0) > li:eq(2) > a").on("click",function(){$("nav.navbar ul.navbar-nav > li").removeClass("active");$(this).parent().addClass("active")});$("nav.navbar ul.navbar-right:eq(1) > li > a").on("click",function(){$("nav.navbar ul.navbar-nav > li").removeClass("active");$(this).parent().addClass("active")});$("nav.navbar ul.navbar-right:eq(0) > li > ul.dropdown-menu a.dropdown-item").on("click",function(){$("nav.navbar ul.navbar-nav > li").removeClass("active");let type=$(this).text();console.log("要展示的用户信息界面种类",type);showUserPage=type;showUserInfo()})}function user_login(){if($("#"+static_components.component_user_login.cid).length===0){loadingAnimation("#body-container").then(function(){$.get(static_components.component_user_login.curl,function(a){if(a!==undefined||a!==""){$("#body-container").html(a)}else{ajaxNoContent("#body-container")}}).fail(function(){ajaxFailed("#body-container")})})}}function user_register(){if($("#"+static_components.component_user_register.cid).length===0){loadingAnimation("#body-container").then(function(){$.get(static_components.component_user_register.curl,function(a){if(a!==undefined||a!==""){$("#body-container").html(a)}else{ajaxNoContent("#body-container")}}).fail(function(){ajaxFailed("#body-container")})})}}function index_body(){if($("#"+static_components.component_index.cid).length===0){loadingAnimation("#body-container").then(function(){$.get(static_components.component_index.curl,function(a){if(a!==undefined||a!==""){$("#body-container").html(a)}else{ajaxNoContent("#body-container")}}).fail(function(){ajaxFailed("#body-container")})})}}function showAllGame(){loadingAnimation("#body-container").then(function(){$.get(static_components.component_all_game.curl,function(a){if(a!==undefined||a!==""){$("#body-container").html(a)}else{ajaxNoContent("#body-container")}}).fail(function(){ajaxFailed("#body-container")})})}function showUserInfo(){loadingAnimation("#body-container").then(function(){$.get(static_components.component_user_information.curl,function(a){if(a!==undefined||a!==""){$("#body-container").html(a)}else{ajaxNoContent("#body-container")}}).fail(function(){ajaxFailed("#body-container")})})}function logout(){$.get(requestmap.user_logout,function(a){if(a.status===1){clearUserInfo();myAlert("您已成功退出!",function(){$(window).attr("location","/")})}else{myAlert("退出失败了，请稍后再试!")}}).fail(function(){ajaxFailed("#body-container")})};